<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ETF Tracker</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body style="background:#111;color:#f0f0f0;font-family:sans-serif;padding:20px">
  <h2>ETF Portfolio Tracker</h2>
  <input id="tickers" placeholder="e.g. SPY,QQQ" style="width:300px;padding:6px" />
  <button onclick="analyze()" style="padding:6px 12px;margin-left:10px">Analyze</button>
  <pre id="output" style="margin-top:20px"></pre>
  <div id="chart" style="width:100%;height:500px;margin-top:30px"></div>

  <script>
    async function analyze() {
      const tickers = document.getElementById("tickers").value.split(',');
      const res = await fetch("http://localhost:5000/analyze", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({tickers})
      });
      const json = await res.json();
      document.getElementById("output").textContent = JSON.stringify(json, null, 2);
      const names = Object.keys(json);
      const sharpes = names.map(t => json[t].sharpe);
      const vols = names.map(t => json[t].volatility);
      const dds = names.map(t => json[t].max_drawdown);
      Plotly.newPlot("chart", [
        { x: names, y: sharpes, type: 'bar', name: 'Sharpe Ratio' },
        { x: names, y: vols, type: 'bar', name: 'Volatility' },
        { x: names, y: dds, type: 'bar', name: 'Max Drawdown' }
      ], {
        title: 'ETF Risk Metrics',
        barmode: 'group'
      });
    }
  </script>
</body>
</html>
